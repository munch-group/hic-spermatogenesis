<!DOCTYPE html>
<html lang="en"><head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="defence_files/libs/clipboard/clipboard.min.js"></script>
<script src="defence_files/libs/quarto-html/tabby.min.js"></script>
<script src="defence_files/libs/quarto-html/popper.min.js"></script>
<script src="defence_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="defence_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="defence_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="defence_files/libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.40">

  <meta name="author" content="Søren Jørgensen">
  <meta name="author" content="Kasper Munch (Supervisor)">
  <meta name="dcterms.date" content="2025-01-30">
  <title>Chromatin Architecture and Selection on X</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="defence_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="defence_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="defence_files/libs/revealjs/dist/theme/quarto-fe54d43e668050a04a3aedbd1877054b.css">
  <link href="defence_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="defence_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="defence_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="defence_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
  
  <script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-notes="<em>Opening:</em> Welcome everyone, and thank you all for joining in to listen to what I’ve spent my time doing since September. Let’s get started. The X chromosome stands out in our genome due to its unique inheritance and hemizygosity in males, which is a probable cause of reduced diversity. We then ask a fundamental question: Could chromatin architecture help explain observed patterns of reduced diversity on X? [45s]" class="quarto-title-block center">
  <h1 class="title">Chromatin Architecture and Selection on X</h1>
  <p class="subtitle">Thesis Defence: Msc. Project 2024</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Søren Jørgensen 
</div>
        <p class="quarto-title-affiliation">
            Stud. MSc. Bioinformatics, BiRC
          </p>
    </div>
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Kasper Munch (Supervisor) 
</div>
        <p class="quarto-title-affiliation">
            Associate Professor, BiRC
          </p>
    </div>
</div>

  <p class="date">January 30, 2025</p>
</section>
<section id="overview" class="slide level2">
<h2>Overview</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[[1,1],[1,1]]" style="margin-top:30pt;">
<div class="quarto-layout-row">
<div id="always-visible" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Research question</li>
<li>Reduced Diversity on X</li>
<li>Rationale</li>
</ul>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Chromosome Architecture</li>
<li>Compartments</li>
<li>TADs</li>
</ul>
</div>
</div>
<div class="quarto-layout-row">
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Compartment Inference</li>
<li>Genomic Comparison</li>
<li>Regions under selection</li>
</ul>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<ul>
<li>Compartment calls</li>
<li>Test results</li>
<li>Implications</li>
<li>Future</li>
</ul>
</div>
</div>
</div>
<div class="fragment alert" style="text-align:center;">
<p>All code, figures, analyses, and slides are available at <br> <a href="https://munch-group.org/hic-spermatogenesis/">https://munch-group.org/hic-spermatogenesis/</a></p>
</div>
<aside class="notes">
<p>Now, let me briefly give an overview of this talk. First, I will give a brief introduction to the analysis I did, expand a bit about reduced diversity on X, and connecting the two. (click) I will introduce you to the hierarchical structures of our DNA, especially the higher-order organization, Topologically Associating Domains and A/B compartments. (click) I will show how I generate Hi-C interaction matrices and infer the compartments on macaque Hi-C data, and how I correlate the genomic coordinates with the regions under selection in baboons and human. (click) I will go through some compartment calls and the test results from correlating the genomic intervals. Finally, I will discuss the meaning of the results and what to focus on in the future. (click) A major part of this project is reproducibility, which I will talk a bit about later on, but for now, I will let you know that all code, figures, analyses and these slides are available at munch-group.org/hic-spermatogenesis. Let’s move on. [2min]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="introduction-and-background" class="slide level2">
<h2>Introduction and Background</h2>
<div class="fragment">
<h3 id="what-have-we-done">What have we done</h3>
<p>Analyzed the 3D chromatin structure on X during spermatogenesis in rhesus macaque and correlating to low-diversity regions in baboons and humans, leveraging a comprehensive reproducible computational framework.</p>
</div>
<div class="fragment">
<h3 id="reduced-diversity-on-x">Reduced Diversity on X</h3>
<p>Megabase-spanning regions of reduced diversity across great apes indicate strong selection, reflecting evolutionary dynamics that possibly interplay with structural features.</p>
</div>
<div class="fragment">
<h3 id="rationale-of-analyzing-chromatin-architecture">Rationale of analyzing chromatin architecture</h3>
<p>Architecture modulates gene regulation and meiosis. Could these high-level structural features underlie the low-diversity regions?</p>
</div>
<aside class="notes">
<p>In this study, we explore the X chromosome in rhesus macaque (Macaca mulatta), combining Hi-C analysis with genomic tools to unravel its 3D chromatin structure. Our goal? To investigate how chromatin architecture intertwines with evolutionary forces, particularly in regions under strong selection. What are those regions under selection This forms the rationale. I ask… [3min]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="molecular-biology-chromosome-architecture" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Molecular Biology: Chromosome Architecture</h2>
<div class="fragment" data-fragment-index="1">
<h3 id="chromosome-architecture-in-the-nucleus">Chromosome Architecture in the Nucleus</h3>
<ul>
<li>Balance <span class="alert">compact storage</span> with <span class="alert">functional accessibility</span> for essential processes: replication and gene expression.<br>
</li>
</ul>
</div>
<div class="fragment" data-fragment-index="2">
<div class="columns">
<div class="column" style="width:45%;">
<h3 id="levels-of-organization">Levels of Organization</h3>
<div>
<ul>
<li class="fragment">Double Helix</li>
<li class="fragment">Nucleosomes</li>
<li class="fragment"><span class="alert">Chromatin</span></li>
</ul>
</div>
<div>

</div>
<div class="fragment quarto-layout-panel" data-layout="[-0.01,0.3,0.6]" style="font-size:20pt;">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 1.1%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div id="col1" class="quarto-layout-cell" data-id="fiber-loop" style="flex-basis: 33.0%;justify-content: flex-start;">
<ul>
<li>Fibers</li>
<li>Loops</li>
</ul>
</div>
<div id="col2" class="quarto-layout-cell" data-id="dom-comp" style="flex-basis: 65.9%;justify-content: flex-start;">
<ul>
<li>Domains (TADs)</li>
<li>Compartments</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="absolute" style="bottom: 30px; right: 0px; width: 77%; height: 77%; ">
<p><img data-src="images/chromatin-intro.jpg" class="absolute" style="bottom: 0px; right: 0px; width: 75%; height: 75%; "></p>
</div>
<div class="tinynote absolute" style="bottom: 32px; right: 5px; ">
<p>Figure from <span class="citation" data-cites="misteli2020selforganizinggenomeprinciples">(<a href="#/references" role="doc-biblioref" onclick="">Misteli 2020</a>)</span></p>
</div>
</div>
<aside class="notes">
<p>chromatin must balance structure and function. nucleosomes makwa DNA compact yet accessible. - <strong>DNA Double Helix</strong>: Fundamental structure of DNA. - <strong>Nucleosomes</strong>: DNA wrapped around histone proteins, forming the “beads-on-a-string” structure. - <strong>Chromatin Fibers</strong>: Higher-order coiling of nucleosomes for compact organization. [4min]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="molecular-biology-chromatin-architecture" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Molecular Biology: Chromatin Architecture</h2>
<h3 id="chromosome-architecture-in-the-nucleus-1">Chromosome Architecture in the Nucleus</h3>
<div class="columns">
<div class="column" style="width:28%;">
<ul>
<li>Compact storage</li>
<li>Accessibility</li>
</ul>
<h3 id="chromatin">Chromatin</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[1]">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" data-id="fiber-loop" style="flex-basis: 100.0%;justify-content: flex-start;">
<ul>
<li>Fibers</li>
<li>Loops</li>
</ul>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" data-id="dom-comp" style="flex-basis: 100.0%;justify-content: flex-start;">
<ul>
<li>Domains (TADs)</li>
<li>Compartments</li>
</ul>
</div>
</div>
</div>
</div></div>
<div class="absolute" style="margin:0; padding:0;bottom: 30px; right: 0px; width: 77%; height: 77%; ">
<p><img data-src="images/chromatin-intro.jpg" class="absolute" style="bottom: 0px; right: 0px; width: 100%; height: 100%; "></p>
</div>
<div class="tinynote absolute" style="bottom: 32px; right: 5px; ">
<p>Figure from <span class="citation" data-cites="misteli2020selforganizinggenomeprinciples">(<a href="#/references" role="doc-biblioref" onclick="">Misteli 2020</a>)</span></p>
</div>
<aside class="notes">
<p>[4m45s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="molecular-biology-compartments" class="slide level2" data-auto-animate="true">
<h2 data-id="quarto-animate-title">Molecular Biology: Compartments</h2>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[[50, 50],[40,-60]]">
<div class="quarto-layout-row">
<div id="non-fragment" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<h3 id="topologically-associating-domains-tads">Topologically Associating Domains (TADs)</h3>
<ul>
<li>Self-interacting chromatin domains that insulate regulatory interactions.<br>
</li>
<li>Act as boundaries to regulate enhancer-promoter interactions.</li>
</ul>
</div>
<div id="non-fragment2" class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<h3 id="ab-compartments">A/B Compartments</h3>
<ul>
<li>A-Compartments: Gene-rich, active, euchromatin regions.<br>
</li>
<li>B-Compartments: Gene-poor, inactive, heterochromatin regions.</li>
</ul>
</div>
</div>
<div class="quarto-layout-row">
<div class="fragment alert quarto-layout-cell" style="flex-basis: 40.0%;justify-content: flex-start;">
<h3 id="key-differences">Key differences</h3>
<ul>
<li>Method of inference</li>
<li>Size</li>
</ul>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 60.0%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
</div>
<div class="absolute" style="bottom: 30px; right: 0px; width: 77%; height: 77%; ">
<p><img data-src="images/chromatin-intro.jpg" class="absolute" style="bottom: 0px; right: 0px; width: 65%; height: 60%; "></p>
</div>
<div class="tinynote absolute" style="bottom: 32px; right: 5px; ">
<p>Figure from <span class="citation" data-cites="misteli2020selforganizinggenomeprinciples">(<a href="#/references" role="doc-biblioref" onclick="">Misteli 2020</a>)</span></p>
</div>
<aside class="notes">
<ul>
<li>Self-interacting chromatin domains, often referred to as TADs, play a key role in insulating regulatory interactions. They act as boundaries, ensuring that enhancers only interact with their target promoters, which helps maintain precise gene regulation and prevents unwanted cross-talk between adjacent genes. TAD boundaries are typically enriched in structural proteins (CTCF motif), and specific histone modifications (e.g.&nbsp;H3K4me3) marking promoter/enhancers.</li>
<li>Now, A/B compartments are large genomic regions that organize the nucleus into functional zones. A compartments are gene-rich and transcriptionally active, while B compartments are gene-poor and largely inactive. This separation allows the genome to balance accessibility for active genes with compact storage for inactive regions, optimizing nuclear function.</li>
<li>The key difference between the TADs and A/B compartments is the method of inference, where TADs are notoriously hard to call, but initially, the size was the separator: TADs were sub-megabase and A/B compartments were multiple megabases. [7m00s]</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="hi-c-chromosome-conformation-capture" class="slide level2" data-auto-animate="true" data-auto-animate-id="chrom-cap">
<h2 data-id="quarto-animate-title">Hi-C (Chromosome Conformation Capture)</h2>
<h3 id="how-to-capture-chromosome-conformation">How to capture chromosome conformation:</h3>
<p><img data-src="images/hic-schematic-cutout.png" class="fragment absolute" style="bottom: 30px; right: 50px; height: 75%; " data-fragment-index="1" data-id="schematic"></p>
<div class="tinynote absolute fragment" data-fragment-index="1" style="bottom: 33px; right: 55px; ">
<p>From <span class="citation" data-cites="wikimedia:HiCschematic">(<a href="#/references" role="doc-biblioref" onclick="">WikiCommons:Prakrutiuday</a>)</span></p>
</div>
<aside class="notes">
<p><em>So, how is the 3D organization of DNA in the nucleus captured?</em> To understand the data, we must know a bit about how the samples are generated. Let us briefly visit the wet-lab. Here, the cells are fixed and proximal DNA strands are crosslinked. [2m20s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="hi-c-chromosome-conformation-capture-1" class="slide level2" data-auto-animate="true" data-auto-animate-id="chrom-cap">
<h2 data-id="quarto-animate-title">Hi-C (Chromosome Conformation Capture)</h2>

<img data-src="images/fig-hic-data-analysis.png" data-id="schematic" class="r-stretch"><aside class="notes">
<p>[11m00s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="hi-c-chromosome-conformation-capture-2" class="slide level2" data-auto-animate="true" data-auto-animate-id="chrom-cap">
<h2 data-id="quarto-animate-title">Hi-C (Chromosome Conformation Capture)</h2>
<!--{{< embed ../notebooks/07_various plotting.ipynb#hic-example >}}-->
<!-- add the saved .png in stead for auto-animation to work-->
<p><img data-src="images/hic-example.png" class="absolute" style="margin: auto auto;left: 0px; bottom: 30px; right: 0px; height: 86%; " data-id="schematic"></p>
<aside class="notes">
<p>Here is the heat map, showing the checkerboard pattern. Darker spots signify an interaction between two places in the genome. Dark squaresa along the diagonal would be TADs. But how do we get from matrix to the 1D track of compartment type? [12m15]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="inference-methods-ab-compartments" class="slide level2">
<h2>Inference Methods: A/B compartments</h2>
<div>
<ul>
<li class="fragment"><span class="alert">PCA</span>: Captures compartmentalization by minimizing the error between observed and predicted frequencies</li>
<li class="fragment"><span class="alert">PC1</span>: Reflects A/B compartment assignments, sign (+/-) indicates type (A/B).
<ul>
<li class="fragment"><span class="alert">How?</span></li>
</ul></li>
</ul>
</div>
<div>

</div>
<div id="rationale" class="quarto-layout-panel" data-layout="[-2.5,95,-2.5]" style="margin-top:-10pt;font-size:0.79em;font-family:math;color:#6f4747;">
<div class="quarto-layout-row">
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 2.5%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
<div class="quarto-layout-cell" style="flex-basis: 95.0%;justify-content: flex-start;">
<ol type="1">
<li class="fragment">Assign each bin <span class="math inline">\(x\)</span> a compartment value <span class="math inline">\(c(x)\)</span>.<br>
</li>
<li class="fragment">Define interaction score as <span class="math inline">\(I(x,y) = c(x)c(y)\)</span>, with <span class="math inline">\(I(x,y) &gt; 0\)</span> for same-compartment loci.<br>
</li>
<li class="fragment">Optimize <span class="math inline">\(c(x)\)</span> via PCA to minimize MSE between observed interactions and <span class="math inline">\(c(x)c(y)\)</span>.<br>
</li>
<li class="fragment">Use GC content to orient the eigenvector, assigning loci to A (<span class="math inline">\(c(x) &gt; 0\)</span>) or B (<span class="math inline">\(c(x) &lt; 0\)</span>).<br>
</li>
<li class="fragment">Constrain MSE minimization to a genomic range (e.g., chromosome arms).<br>
</li>
</ol>
</div>
<div class="quarto-figure-spacer quarto-layout-cell" style="flex-basis: 2.5%;justify-content: flex-start;">
<p>&nbsp;</p>
</div>
</div>
</div>
<aside class="notes">
<ol type="1">
<li><strong>Compartment Assignment:</strong> Each genomic bin <span class="math inline">\(x\)</span> is assigned a compartment value <span class="math inline">\(c(x)\)</span>, representing whether it belongs to compartment A or B. The goal is to determine <span class="math inline">\(c(x)\)</span> for all bins</li>
<li><strong>Interaction Score:</strong> The interaction between two loci, <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>, is modeled as <span class="math inline">\(I(x,y) = c(x)c(y)\)</span>. If they belong to the same compartment, their interaction score is positive (<span class="math inline">\(I(x,y) &gt; 0\)</span>), indicating enriched interactions.</li>
<li><strong>PCA Optimization:</strong> Principal Component Analysis (PCA) finds <span class="math inline">\(c(x)\)</span> by minimizing the mean squared error (MSE) between observed Hi-C interaction frequencies and the predicted values <span class="math inline">\(c(x)c(y)\)</span>. If the compartment pattern is strong, PCA effectively captures it.</li>
<li><strong>Eigenvector Orientation:</strong> Since PCA eigenvectors are only determined up to a sign, an external biological feature—such as GC content—is used to orient the compartment assignments. This ensures that positive <span class="math inline">\(c(x)\)</span> values correspond to compartment A and negative values to compartment B.</li>
<li><strong>Genomic Range Restriction:</strong> The MSE minimization can be restricted to specific genomic regions, such as chromosome arms, to focus on local compartment structures rather than genome-wide patterns.</li>
</ol>
<p>[15m15s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="methods" class="slide level2" data-auto-animate-reset="true">
<h2>Methods</h2>
<div style="margin-bottom:30px;">
<ul>
<li class="fragment">Infer compartments using <em>HiCExplorer</em> or <em>Open2C</em></li>
<li class="fragment">Try to reproduce the compartments from <span class="citation" data-cites="wang2019reprogrammingmeioticchromatin">Wang et al. (<a href="#/references" role="doc-biblioref" onclick="">2019</a>)</span> in fibroblast</li>
<li class="fragment">Success with <em>Open2c</em>:</li>
</ul>
</div>

<img data-src="images/overlay-smoothed.png" class="fragment r-stretch"><aside class="notes">
<p>Now, I think we are ready to move on to <strong><em>my</em></strong> analysis. First, I wanted to reproduce the compartments from Wang, but it was not possible with HiCExplorer. As I mentioned earlier, it is sometimes necessary to restrict the viewframe of the PCA, if the variance between chrom.arms is larger than within each arm. However, I think I succeeded with Open2C (applause). (Zoom in) This result took 9 weeks to obtain. [16m45s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="results-compartments" class="slide level2" data-auto-animate="true" data-auto-animate-id="compartments">
<h2 data-id="quarto-animate-title">Results: Compartments</h2>
<ul>
<li>PC1 compartments were obtained
<ul>
<li>Tissue: fibroblast, spermatogonia, pachytene spermatocyte, round spermatid, sperm</li>
<li>Resolutions: 100kb, 500kb, ps500kb</li>
<li>Viewframe: full, arms, 10Mb windows</li>
</ul></li>
<li>PC1 tracks for each tissue type: <span class="alert">9</span></li>
</ul>
<aside class="notes">
<p>[18m15s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="results-compartments-1" class="slide level2 smaller" data-auto-animate="true" data-auto-animate-id="compartments">
<h2 data-id="quarto-animate-title">Results: Compartments</h2>
<ul>
<li>PC1 compartments were obtained
<ul>
<li>Tissue: fibroblast, spermatogonia, pachytene spermatocyte, round spermatid, sperm</li>
<li>Resolutions: 100kb, 500kb, ps500kb</li>
<li>Viewframe: full, arms, 10Mb windows</li>
</ul></li>
</ul>
<div style="margin-top:-20pt;">
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/hic-spermatogenesis/hic-spermatogenesis/notebooks/05_rec_compartments.ipynb" data-notebook-title="Compartments Analysis w. recommended parameters" data-notebook-cellid="cell-e1-fullmerged-all-100kb">
<div id="cell-e1-fullmerged-all-100kb" class="cell" data-execution_count="17">
<div class="cell-output cell-output-display column-page-inset">
<div>
<figure>
<p><img data-src="defence_files/figure-revealjs/..-notebooks-05_rec_compartments-e1-fullmerged-all-100kb-output-1.png" id="e1-fullmerged-all-100kb" width="891" height="440"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>[20m25s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="results-compartments-2" class="slide level2" data-auto-animate="true" data-auto-animate-id="compartments">
<h2 data-id="quarto-animate-title">Results: Compartments</h2>
<ul>
<li>PC1 compartments were obtained
<ul>
<li>Tissue: fibroblast, spermatogonia, pachytene spermatocyte, round spermatid, sperm</li>
<li>Resolutions: 100kb, 500kb, ps500kb</li>
<li>Viewframe: full, arms, 10Mb windows</li>
</ul></li>
<li>Define sets of intervals
<ul>
<li>A 200kb transition zone between A/B compartments</li>
<li>A 1bp <em>limit</em> between A/B compartments</li>
</ul></li>
</ul>
<aside class="notes">
<p>[21m50s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="genomic-intervals" class="slide level2">
<h2>Genomic Intervals</h2>
<h3 id="introducing-the-regions-of-selection">Introducing the regions of selection</h3>
<ul>
<li>Baboons: Disproportionate parent ancestry on X
<ul>
<li>Either olive baboon (<em>P. anubis</em>) or hamadryas (<em>P. hamadryas</em>)</li>
</ul></li>
<li>Human: ECH90 regions
<ul>
<li>Extraordinary selective sweeps on X (Extended Common Haplotypes 90% peak). From <span class="citation" data-cites="skov2023extraordinaryselectionhuman">Skov et al. (<a href="#/references" role="doc-biblioref" onclick="">2023</a>)</span></li>
</ul></li>
</ul>
<div style="margin-top:-15pt;">
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/hic-spermatogenesis/hic-spermatogenesis/notebooks/07_various_plotting.ipynb" data-notebook-title="Various Comparisons" data-notebook-cellid="cell-introduce-selected-regions-slides">
<div id="cell-introduce-selected-regions-slides" class="cell">
<div class="cell-output cell-output-display">
<div>
<figure>
<p><img data-src="defence_files/figure-revealjs/..-notebooks-07_various_plotting-introduce-selected-regions-slides-output-1.png" id="introduce-selected-regions-slides" width="998" height="147"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>It’s time to talk more about the regions of interest: baboon regions are from unplished analyses (Kasper, Erik), showing disproportionate ancestry of either olive or hamadryas baboons indicating strong selection. The ECH90 regions are from a published paper (dare I say it’s a BiRC paper involving Kasper), identifying extraordinarily long sweeps on X. One of them double the size of the sweep associated with lactase persistence gene. Well, here they are, the regions we use. We also use a merged version of the baboons (they do not overlap). [23m20s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="methods-comparing-genomic-intervals" class="slide level2">
<h2>Methods: Comparing Genomic Intervals</h2>
<h3 id="how-to-compare-intervals">How to compare intervals</h3>
<div>

</div>
<div class="fragment quarto-layout-panel" data-layout-ncol="2">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Jaccard test</strong></p>
<ol type="1">
<li class="fragment">Calculate the Jaccard index between two sets of segments, <span class="math inline">\(Q\)</span> and <span class="math inline">\(A\)</span> <span class="math display">\[
  J(Q, A) = \frac{|Q \cap A|}{|Q \cup A|}
  \]</span></li>
<li class="fragment">Bootstrap <span class="math inline">\(Q\)</span>: <span class="math inline">\(shuffle+reorder\)</span> while conserving segment <span class="math inline">\(lengths\)</span></li>
</ol>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: flex-start;">
<p><strong>Proximity test</strong></p>
<ol type="1">
<li class="fragment">Remove overlapping segments between <span class="math inline">\(Q\)</span> and <span class="math inline">\(A\)</span></li>
<li class="fragment">Calculate a proximity index between two sets of segments, <span class="math inline">\(Q\)</span> and <span class="math inline">\(A\)</span>. <span class="math display">\[
  P(Q, A) = \frac{1}{|Q|} \sum_{q \in Q} \min_{a \in A} d(q, a)
  \]</span></li>
<li class="fragment">Bootstrap <span class="math inline">\(Q\)</span> in the same manner</li>
</ol>
</div>
</div>
</div>
<aside class="notes">
<p><strong>Jaccard:</strong> Calculate intersection over union <strong>Proximity:</strong> Calculate the mean of the distance from each segment in <span class="math inline">\(Q\)</span> to the nearest segment in <span class="math inline">\(A\)</span> [24m00s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="results-comparing-genomic-intervals" class="slide level2">
<h2>Results: Comparing Genomic Intervals</h2>
<div>
<ul>
<li class="fragment">ECH90 overlaps with fibroblast and round spermatid 200kb transition zones (<span class="math inline">\(p \sim 0.01\)</span>)</li>
<li class="fragment">What happens when only using the <em>limits</em>?
<ul>
<li class="fragment"><span class="math inline">\(Q\)</span>: full ECH, baboon limits (separate and concatenated groups)</li>
<li class="fragment"><span class="math inline">\(A\)</span>: PC1 limits (arms, 10Mb)</li>
</ul></li>
</ul>
</div>
<div class="fragment border" style="font-size:20pt;">
<div class="quarto-embed-nb-cell" data-notebook="/home/runner/work/hic-spermatogenesis/hic-spermatogenesis/notebooks/09_defence.ipynb" data-notebook-title="Benjamini-Hochberg adjusted p-values" data-notebook-cellid="cell-tbl-test-results-uncorrected">
<div id="tbl-test-results-uncorrected" class="cell" data-execution_count="21">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_a6778 .col0 {
  min-width: 20px;
}
#T_a6778 .col1 {
  min-width: 20px;
}
#T_a6778 .col2 {
  min-width: 20px;
}
#T_a6778 .col3 {
  min-width: 20px;
}
#T_a6778 .col4 {
  min-width: 20px;
}
#T_a6778_row0_col0 {
  background-color: #f6583e;
  color: #f1f1f1;
}
#T_a6778_row0_col1, #T_a6778_row3_col1 {
  background-color: #a50f15;
  color: #f1f1f1;
}
#T_a6778_row0_col2, #T_a6778_row0_col3, #T_a6778_row1_col0, #T_a6778_row1_col1, #T_a6778_row1_col2, #T_a6778_row1_col3, #T_a6778_row2_col0, #T_a6778_row2_col3, #T_a6778_row3_col4, #T_a6778_row4_col0, #T_a6778_row4_col1, #T_a6778_row4_col3, #T_a6778_row4_col4 {
  background-color: #000000;
  color: #f1f1f1;
  color: transparent;
  background-color: transparent;
}
#T_a6778_row0_col4 {
  background-color: #fff5f0;
  color: #000000;
}
#T_a6778_row1_col4 {
  background-color: #e43027;
  color: #f1f1f1;
}
#T_a6778_row2_col1 {
  background-color: #f14331;
  color: #f1f1f1;
}
#T_a6778_row2_col2 {
  background-color: #ce1a1e;
  color: #f1f1f1;
}
#T_a6778_row2_col4 {
  background-color: #73030f;
  color: #f1f1f1;
}
#T_a6778_row3_col0 {
  background-color: #e83429;
  color: #f1f1f1;
}
#T_a6778_row3_col2 {
  background-color: #9d0d14;
  color: #f1f1f1;
}
#T_a6778_row3_col3 {
  background-color: #fc8565;
  color: #f1f1f1;
}
#T_a6778_row4_col2 {
  background-color: #fcbca2;
  color: #000000;
}
</style>

<table id="T_a6778" class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="index_name level0" data-quarto-table-cell-role="th">tissue</th>
<th id="T_a6778_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Fb</th>
<th id="T_a6778_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Spa</th>
<th id="T_a6778_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Pac</th>
<th id="T_a6778_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">RS</th>
<th id="T_a6778_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Sperm</th>
</tr>
<tr class="even">
<th class="index_name level0" data-quarto-table-cell-role="th">viewframe</th>
<th class="index_name level1" data-quarto-table-cell-role="th">test</th>
<th class="index_name level2" data-quarto-table-cell-role="th">query</th>
<th class="blank col0" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" id="T_a6778_level0_row0" class="row_heading level0 row0" data-quarto-table-cell-role="th">10Mb</td>
<td id="T_a6778_level1_row0" class="row_heading level1 row0" data-quarto-table-cell-role="th">jaccard</td>
<td id="T_a6778_level2_row0" class="row_heading level2 row0" data-quarto-table-cell-role="th">ECH90</td>
<td id="T_a6778_row0_col0" class="data row0 col0">0.021</td>
<td id="T_a6778_row0_col1" class="data row0 col1">0.006</td>
<td id="T_a6778_row0_col2" class="data row0 col2">nan</td>
<td id="T_a6778_row0_col3" class="data row0 col3">nan</td>
<td id="T_a6778_row0_col4" class="data row0 col4">0.048</td>
</tr>
<tr class="even">
<td rowspan="2" id="T_a6778_level1_row1" class="row_heading level1 row1" data-quarto-table-cell-role="th">proximity</td>
<td id="T_a6778_level2_row1" class="row_heading level2 row1" data-quarto-table-cell-role="th">olive</td>
<td id="T_a6778_row1_col0" class="data row1 col0">nan</td>
<td id="T_a6778_row1_col1" class="data row1 col1">nan</td>
<td id="T_a6778_row1_col2" class="data row1 col2">nan</td>
<td id="T_a6778_row1_col3" class="data row1 col3">nan</td>
<td id="T_a6778_row1_col4" class="data row1 col4">0.016</td>
</tr>
<tr class="odd">
<td id="T_a6778_level2_row2" class="row_heading level2 row2" data-quarto-table-cell-role="th">olivehama</td>
<td id="T_a6778_row2_col0" class="data row2 col0">nan</td>
<td id="T_a6778_row2_col1" class="data row2 col1">0.019</td>
<td id="T_a6778_row2_col2" class="data row2 col2">0.012</td>
<td id="T_a6778_row2_col3" class="data row2 col3">nan</td>
<td id="T_a6778_row2_col4" class="data row2 col4">0.001</td>
</tr>
<tr class="even">
<td rowspan="2" id="T_a6778_level0_row3" class="row_heading level0 row3" data-quarto-table-cell-role="th">arms</td>
<td id="T_a6778_level1_row3" class="row_heading level1 row3" data-quarto-table-cell-role="th">jaccard</td>
<td id="T_a6778_level2_row3" class="row_heading level2 row3" data-quarto-table-cell-role="th">ECH90</td>
<td id="T_a6778_row3_col0" class="data row3 col0">0.017</td>
<td id="T_a6778_row3_col1" class="data row3 col1">0.006</td>
<td id="T_a6778_row3_col2" class="data row3 col2">0.005</td>
<td id="T_a6778_row3_col3" class="data row3 col3">0.028</td>
<td id="T_a6778_row3_col4" class="data row3 col4">nan</td>
</tr>
<tr class="odd">
<td id="T_a6778_level1_row4" class="row_heading level1 row4" data-quarto-table-cell-role="th">proximity</td>
<td id="T_a6778_level2_row4" class="row_heading level2 row4" data-quarto-table-cell-role="th">olivehama</td>
<td id="T_a6778_row4_col0" class="data row4 col0">nan</td>
<td id="T_a6778_row4_col1" class="data row4 col1">nan</td>
<td id="T_a6778_row4_col2" class="data row4 col2">0.036</td>
<td id="T_a6778_row4_col3" class="data row4 col3">nan</td>
<td id="T_a6778_row4_col4" class="data row4 col4">nan</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="absolute alert border fragment" style="top:232px; left:500px; border-left:2pt dotted grey; padding:20px;font-size:0.8em;background-color:rgba(255,255,255,0.9);">
<p><span class="math inline">\(\leftarrow 2\times 40\)</span> tests. What about multiple testing?</p>
</div>
<aside class="notes">
<p>When first testing the transition zones, I found overlap: ECH with fibroblast and round spermatid. Initially, I also found significant proximity, but when I updated the test, it dissapeared, sadly. I started testing the transition zones as I thought it would allow for some uncertainty in the positions, and had only small hopes for testing the <em>limits</em>. Here, we use Let’s see what came out of it (click) –&gt; boom. *Head scratching*. Let’s unpack. Still, fibroblast and round spermatid limits <em>overlap</em> the ECH regions, but the p-value is lower for the 200kb transition zone. Additionally, spermatogonia and pachytene spermatocyte limits overlap ECH, so now all tissues except sperm overlaps ECH in their compartment limits. What is surprising is that in some cases, the compartment limits are both significantly proximal to the concatenated baboon set <em>and</em> overlaps the ECH90 regions. Also note the very low p-value for proximity between baboon limits and sperm samples. (click) We observe 7 and 5 significant p-values out of 40 for Jaccard and Proximity tests, respectively. That is more than double the amount expected by change. But we still have to talk a bit about multiple testing. The tests are not independent as the different viewframes still originate from the same data, and the compartments called from the two viewframes are highly similar. That means that multiple testing correction gets complicated, and naively correcting the p-values is too conservative. However, I made the corrections to get an idea of the impact of multiple tests. Here is what I got: (click) [27m00s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="results-comparing-genomic-intervals-1" class="slide level2">
<h2>Results: Comparing Genomic Intervals</h2>
<h3 id="multiple-testing-correction">Multiple testing correction</h3>
<div>

</div>
<div class="quarto-layout-panel" data-layout="[[1,3],[1,3]]" style="font-size:20pt;">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<p><span style="margin-top:20pt;"><br>Uncorrected:</span></p>
</div>
<div class="quarto-embed-nb-cell quarto-layout-cell" data-notebook="/home/runner/work/hic-spermatogenesis/hic-spermatogenesis/notebooks/09_defence.ipynb" data-notebook-title="Benjamini-Hochberg adjusted p-values" data-notebook-cellid="cell-tbl-test-results-uncorrected" style="flex-basis: 75.0%;justify-content: center;">
<div id="tbl-test-results-uncorrected" class="cell" data-execution_count="21">
<div class="cell-output cell-output-display">
<style type="text/css">
#T_a6778 .col0 {
  min-width: 20px;
}
#T_a6778 .col1 {
  min-width: 20px;
}
#T_a6778 .col2 {
  min-width: 20px;
}
#T_a6778 .col3 {
  min-width: 20px;
}
#T_a6778 .col4 {
  min-width: 20px;
}
#T_a6778_row0_col0 {
  background-color: #f6583e;
  color: #f1f1f1;
}
#T_a6778_row0_col1, #T_a6778_row3_col1 {
  background-color: #a50f15;
  color: #f1f1f1;
}
#T_a6778_row0_col2, #T_a6778_row0_col3, #T_a6778_row1_col0, #T_a6778_row1_col1, #T_a6778_row1_col2, #T_a6778_row1_col3, #T_a6778_row2_col0, #T_a6778_row2_col3, #T_a6778_row3_col4, #T_a6778_row4_col0, #T_a6778_row4_col1, #T_a6778_row4_col3, #T_a6778_row4_col4 {
  background-color: #000000;
  color: #f1f1f1;
  color: transparent;
  background-color: transparent;
}
#T_a6778_row0_col4 {
  background-color: #fff5f0;
  color: #000000;
}
#T_a6778_row1_col4 {
  background-color: #e43027;
  color: #f1f1f1;
}
#T_a6778_row2_col1 {
  background-color: #f14331;
  color: #f1f1f1;
}
#T_a6778_row2_col2 {
  background-color: #ce1a1e;
  color: #f1f1f1;
}
#T_a6778_row2_col4 {
  background-color: #73030f;
  color: #f1f1f1;
}
#T_a6778_row3_col0 {
  background-color: #e83429;
  color: #f1f1f1;
}
#T_a6778_row3_col2 {
  background-color: #9d0d14;
  color: #f1f1f1;
}
#T_a6778_row3_col3 {
  background-color: #fc8565;
  color: #f1f1f1;
}
#T_a6778_row4_col2 {
  background-color: #fcbca2;
  color: #000000;
}
</style>

<table id="T_a6778" class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="index_name level0" style="text-align: left;" data-quarto-table-cell-role="th">tissue</th>
<th id="T_a6778_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">Fb</th>
<th id="T_a6778_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">Spa</th>
<th id="T_a6778_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">Pac</th>
<th id="T_a6778_level0_col3" class="col_heading level0 col3" style="text-align: left;" data-quarto-table-cell-role="th">RS</th>
<th id="T_a6778_level0_col4" class="col_heading level0 col4" style="text-align: left;" data-quarto-table-cell-role="th">Sperm</th>
</tr>
<tr class="even">
<th class="index_name level0" style="text-align: left;" data-quarto-table-cell-role="th">viewframe</th>
<th class="index_name level1" style="text-align: left;" data-quarto-table-cell-role="th">test</th>
<th class="index_name level2" style="text-align: left;" data-quarto-table-cell-role="th">query</th>
<th class="blank col0" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="3" id="T_a6778_level0_row0" class="row_heading level0 row0" style="text-align: left;" data-quarto-table-cell-role="th">10Mb</td>
<td id="T_a6778_level1_row0" class="row_heading level1 row0" style="text-align: left;" data-quarto-table-cell-role="th">jaccard</td>
<td id="T_a6778_level2_row0" class="row_heading level2 row0" style="text-align: left;" data-quarto-table-cell-role="th">ECH90</td>
<td id="T_a6778_row0_col0" class="data row0 col0" style="text-align: left;">0.021</td>
<td id="T_a6778_row0_col1" class="data row0 col1" style="text-align: left;">0.006</td>
<td id="T_a6778_row0_col2" class="data row0 col2" style="text-align: left;">nan</td>
<td id="T_a6778_row0_col3" class="data row0 col3" style="text-align: left;">nan</td>
<td id="T_a6778_row0_col4" class="data row0 col4" style="text-align: left;">0.048</td>
</tr>
<tr class="even">
<td rowspan="2" id="T_a6778_level1_row1" class="row_heading level1 row1" style="text-align: left;" data-quarto-table-cell-role="th">proximity</td>
<td id="T_a6778_level2_row1" class="row_heading level2 row1" style="text-align: left;" data-quarto-table-cell-role="th">olive</td>
<td id="T_a6778_row1_col0" class="data row1 col0" style="text-align: left;">nan</td>
<td id="T_a6778_row1_col1" class="data row1 col1" style="text-align: left;">nan</td>
<td id="T_a6778_row1_col2" class="data row1 col2" style="text-align: left;">nan</td>
<td id="T_a6778_row1_col3" class="data row1 col3" style="text-align: left;">nan</td>
<td id="T_a6778_row1_col4" class="data row1 col4" style="text-align: left;">0.016</td>
</tr>
<tr class="odd">
<td id="T_a6778_level2_row2" class="row_heading level2 row2" style="text-align: left;" data-quarto-table-cell-role="th">olivehama</td>
<td id="T_a6778_row2_col0" class="data row2 col0" style="text-align: left;">nan</td>
<td id="T_a6778_row2_col1" class="data row2 col1" style="text-align: left;">0.019</td>
<td id="T_a6778_row2_col2" class="data row2 col2" style="text-align: left;">0.012</td>
<td id="T_a6778_row2_col3" class="data row2 col3" style="text-align: left;">nan</td>
<td id="T_a6778_row2_col4" class="data row2 col4" style="text-align: left;">0.001</td>
</tr>
<tr class="even">
<td rowspan="2" id="T_a6778_level0_row3" class="row_heading level0 row3" style="text-align: left;" data-quarto-table-cell-role="th">arms</td>
<td id="T_a6778_level1_row3" class="row_heading level1 row3" style="text-align: left;" data-quarto-table-cell-role="th">jaccard</td>
<td id="T_a6778_level2_row3" class="row_heading level2 row3" style="text-align: left;" data-quarto-table-cell-role="th">ECH90</td>
<td id="T_a6778_row3_col0" class="data row3 col0" style="text-align: left;">0.017</td>
<td id="T_a6778_row3_col1" class="data row3 col1" style="text-align: left;">0.006</td>
<td id="T_a6778_row3_col2" class="data row3 col2" style="text-align: left;">0.005</td>
<td id="T_a6778_row3_col3" class="data row3 col3" style="text-align: left;">0.028</td>
<td id="T_a6778_row3_col4" class="data row3 col4" style="text-align: left;">nan</td>
</tr>
<tr class="odd">
<td id="T_a6778_level1_row4" class="row_heading level1 row4" style="text-align: left;" data-quarto-table-cell-role="th">proximity</td>
<td id="T_a6778_level2_row4" class="row_heading level2 row4" style="text-align: left;" data-quarto-table-cell-role="th">olivehama</td>
<td id="T_a6778_row4_col0" class="data row4 col0" style="text-align: left;">nan</td>
<td id="T_a6778_row4_col1" class="data row4 col1" style="text-align: left;">nan</td>
<td id="T_a6778_row4_col2" class="data row4 col2" style="text-align: left;">0.036</td>
<td id="T_a6778_row4_col3" class="data row4 col3" style="text-align: left;">nan</td>
<td id="T_a6778_row4_col4" class="data row4 col4" style="text-align: left;">nan</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 25.0%;justify-content: flex-start;">
<p><span style="margin-top:20pt;"><br>Benjamini-Hochberg (FDR) corrected</span></p>
</div>
<div class="quarto-embed-nb-cell quarto-layout-cell" data-notebook="/home/runner/work/hic-spermatogenesis/hic-spermatogenesis/notebooks/09_defence.ipynb" data-notebook-title="Benjamini-Hochberg adjusted p-values" data-notebook-cellid="cell-tbl-test-results-BH-corrected" style="flex-basis: 75.0%;justify-content: center;">
<div id="tbl-test-results-bh-corrected" class="cell" data-execution_count="20">
<div class="cell-output cell-output-display" data-execution_count="20">
<style type="text/css">
#T_bce2b .col0 {
  min-width: 20px;
}
#T_bce2b .col1 {
  min-width: 20px;
}
#T_bce2b .col2 {
  min-width: 20px;
}
#T_bce2b .col3 {
  min-width: 20px;
}
#T_bce2b .col4 {
  min-width: 20px;
}
#T_bce2b_row0_col0 {
  background-color: #feeae0;
  color: #000000;
}
#T_bce2b_row0_col1, #T_bce2b_row2_col1, #T_bce2b_row2_col2 {
  background-color: #f6553c;
  color: #f1f1f1;
}
#T_bce2b_row0_col2, #T_bce2b_row0_col3, #T_bce2b_row0_col4, #T_bce2b_row1_col0, #T_bce2b_row1_col1, #T_bce2b_row1_col2, #T_bce2b_row1_col3, #T_bce2b_row2_col4 {
  background-color: #000000;
  color: #f1f1f1;
  color: transparent;
  background-color: transparent;
}
#T_bce2b_row1_col4 {
  background-color: #fdd4c2;
  color: #000000;
}
#T_bce2b_row2_col0 {
  background-color: #fee4d8;
  color: #000000;
}
#T_bce2b_row2_col3 {
  background-color: #fff5f0;
  color: #000000;
}
</style>

<table id="T_bce2b" class="caption-top" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th class="blank" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="index_name level0" style="text-align: left;" data-quarto-table-cell-role="th">tissue</th>
<th id="T_bce2b_level0_col0" class="col_heading level0 col0" style="text-align: left;" data-quarto-table-cell-role="th">Fb</th>
<th id="T_bce2b_level0_col1" class="col_heading level0 col1" style="text-align: left;" data-quarto-table-cell-role="th">Spa</th>
<th id="T_bce2b_level0_col2" class="col_heading level0 col2" style="text-align: left;" data-quarto-table-cell-role="th">Pac</th>
<th id="T_bce2b_level0_col3" class="col_heading level0 col3" style="text-align: left;" data-quarto-table-cell-role="th">RS</th>
<th id="T_bce2b_level0_col4" class="col_heading level0 col4" style="text-align: left;" data-quarto-table-cell-role="th">Sperm</th>
</tr>
<tr class="even">
<th class="index_name level0" style="text-align: left;" data-quarto-table-cell-role="th">viewframe</th>
<th class="index_name level1" style="text-align: left;" data-quarto-table-cell-role="th">test</th>
<th class="index_name level2" style="text-align: left;" data-quarto-table-cell-role="th">query</th>
<th class="blank col0" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col1" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col2" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col3" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
<th class="blank col4" style="text-align: left;" data-quarto-table-cell-role="th">&nbsp;</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td rowspan="2" id="T_bce2b_level0_row0" class="row_heading level0 row0" style="text-align: left;" data-quarto-table-cell-role="th">10Mb</td>
<td id="T_bce2b_level1_row0" class="row_heading level1 row0" style="text-align: left;" data-quarto-table-cell-role="th">jaccard</td>
<td id="T_bce2b_level2_row0" class="row_heading level2 row0" style="text-align: left;" data-quarto-table-cell-role="th">ECH90</td>
<td id="T_bce2b_row0_col0" class="data row0 col0" style="text-align: left;">0.043</td>
<td id="T_bce2b_row0_col1" class="data row0 col1" style="text-align: left;">0.020</td>
<td id="T_bce2b_row0_col2" class="data row0 col2" style="text-align: left;">nan</td>
<td id="T_bce2b_row0_col3" class="data row0 col3" style="text-align: left;">nan</td>
<td id="T_bce2b_row0_col4" class="data row0 col4" style="text-align: left;">nan</td>
</tr>
<tr class="even">
<td id="T_bce2b_level1_row1" class="row_heading level1 row1" style="text-align: left;" data-quarto-table-cell-role="th">proximity</td>
<td id="T_bce2b_level2_row1" class="row_heading level2 row1" style="text-align: left;" data-quarto-table-cell-role="th">olivehama</td>
<td id="T_bce2b_row1_col0" class="data row1 col0" style="text-align: left;">nan</td>
<td id="T_bce2b_row1_col1" class="data row1 col1" style="text-align: left;">nan</td>
<td id="T_bce2b_row1_col2" class="data row1 col2" style="text-align: left;">nan</td>
<td id="T_bce2b_row1_col3" class="data row1 col3" style="text-align: left;">nan</td>
<td id="T_bce2b_row1_col4" class="data row1 col4" style="text-align: left;">0.038</td>
</tr>
<tr class="odd">
<td id="T_bce2b_level0_row2" class="row_heading level0 row2" style="text-align: left;" data-quarto-table-cell-role="th">arms</td>
<td id="T_bce2b_level1_row2" class="row_heading level1 row2" style="text-align: left;" data-quarto-table-cell-role="th">jaccard</td>
<td id="T_bce2b_level2_row2" class="row_heading level2 row2" style="text-align: left;" data-quarto-table-cell-role="th">ECH90</td>
<td id="T_bce2b_row2_col0" class="data row2 col0" style="text-align: left;">0.041</td>
<td id="T_bce2b_row2_col1" class="data row2 col1" style="text-align: left;">0.020</td>
<td id="T_bce2b_row2_col2" class="data row2 col2" style="text-align: left;">0.020</td>
<td id="T_bce2b_row2_col3" class="data row2 col3" style="text-align: left;">0.046</td>
<td id="T_bce2b_row2_col4" class="data row2 col4" style="text-align: left;">nan</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
</div>
<aside class="notes">
<p>Now, only the baboon regions are significantly proximal to sperm, but there is still overlap between ECH and the limits of all tissue types except sperm. So, even with a multiple testing correction (that I deem too conservative), there are still a lot of correlation between chromatin compartments in macaque in both fibroblasts and through spermatogenesis, either by intersection or by edge/limit proximity. [27m40s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="implications-and-unanswered-questions" class="slide level2">
<h2>Implications and Unanswered Questions</h2>
<ul>
<li>Assuming the results are real</li>
<li>What does it <em>mean</em> that the regions correlate
<ul>
<li>The ECH paper: hinting to possible mechanisms aiding a fitness-based model</li>
<li>Structural features could aid in preserving certain genetic elements</li>
<li>Some tissues are connected to both ECH and baboon regions</li>
<li>Does fibroblast rule out the implication in spermatogenesis?</li>
</ul></li>
<li>Macaque is often used as an outgroup, but not here
<ul>
<li>Reproduce in great ape data</li>
</ul></li>
</ul>
<aside class="notes">
<p>Let’s for a moment assume that this explorative analysis is sound, and the regions are actually correlating. <em>What does it mean</em> that they do? Well, an extraordinary selection coefficient has been reported for segments in ECH, and one that is more than double the size of the sweep associated with <em>lactase persistence</em>. They hint that other mechanisms could aid the apparent selection by structurally linking regions across the chromosome. Then, the compartment limits were in some tissues associated with both ECH regions and baboon regions, indicating some indirect link. Maybe, some regions are more prone to selection as a result of structural features? Additionally, fibroblast showed overlap to ECH - does that rule out the role of spermatogenesis? Another point that I’ve avoided until now is: macaque is often used as an outgroup to great apes, but here, we find strong correlations between the elements. Can we strengthen our results by reproducing the Hi-C analysis in other (more closely related) species? [29m00s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="reproducibility" class="slide level2">
<h2>Reproducibility</h2>
<div class="{columns}">
<div class="column" style="width:50%;">
<ul>
<li>Can we reproduce in other organisms?
<ul>
<li>The question I have been waiting for</li>
</ul></li>
</ul>
<p><img data-src="images/sponsors.png"></p>
</div><div class="column" style="width:50%;">
<div id="tbl-reproducibility" class="striped quarto-float quarto-figure quarto-figure-center" style="font-size:17pt">
<figure class="quarto-float quarto-float-tbl">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-reproducibility-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Overview of the tools used for reproducibility of this thesis.
</figcaption>
<div aria-describedby="tbl-reproducibility-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="table-striped caption-top">
<thead>
<tr class="header">
<th style="text-align: right;">Tool</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">Jupyter</td>
<td style="text-align: left;">Interactive coding environment for analysis and development (notebooks are natively rendered with Quarto)</td>
</tr>
<tr class="even">
<td style="text-align: right;">Quarto</td>
<td style="text-align: left;">A Quarto Manuscript project nested inside a Quarto Book for rendering html (website) and PDF (manuscript) from Markdown via Pandoc. Supports direct embedding of output from Jupyter Notebook cells (plots, tables).</td>
</tr>
<tr class="odd">
<td style="text-align: right;">Conda</td>
<td style="text-align: left;">For managing software requirements and dependency versions reproducibly.</td>
</tr>
<tr class="even">
<td style="text-align: right;">git</td>
<td style="text-align: left;">Version control and <code>gh-pages</code> branch for automated render of Quarto project</td>
</tr>
<tr class="odd">
<td style="text-align: right;">GitHub</td>
<td style="text-align: left;">Action was triggered <code>on push</code> to render the project and host on <a href="https://munch-group.org/hic-spermatogenesis/">munch-group.org</a></td>
</tr>
<tr class="even">
<td style="text-align: right;"><em>gwf</em></td>
<td style="text-align: left;">Workflow manager to automate the analysis on a HPC cluster, wrapped in Python code. <code>workflow.py</code> currently does everything from <code>.fastq</code> to <code>.cool</code>, but notebooks can be set to run sequentially as part of the workflow as well.</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div></div>
<aside class="notes">
<p>[31m00s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="conclusive-thoughts-and-perspectives" class="slide level2">
<h2>Conclusive thoughts and perspectives</h2>
<ul>
<li>Previous results
<ul>
<li>No such comparison has been performed before (I might be deceived)</li>
</ul></li>
<li>Find a way to weight the compartments based on metadata</li>
<li>We should investigate TADs as well</li>
<li>We should analyze the genes at the coordinates of correlation</li>
<li>Chromosome X is an obvious target</li>
<li>I have only looked at <em>intra</em>-chromosomal interactions</li>
</ul>
<aside class="notes">
<p>[33m00s]</p>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section>
<section id="extra-slides" class="title-slide slide level1 center">
<h1>Extra slides</h1>

</section>
<section id="inference-methods-tads" class="slide level2">
<h2>Inference Methods: TADs</h2>
<p>Call TADs using interaction data summarized into a 1D genomic profile</p>
<div>
<ul>
<li class="fragment"><span class="alert">Insulation Score</span>: Sliding window along the main diagonal</li>
<li class="fragment"><span class="alert">Boundaries</span>: Find local minima along the genome</li>
<li class="fragment"><span class="alert">Define threshold</span>: define a threshold for <em>peak prominence</em>
<ul>
<li class="fragment">Borrow <em>Otsu</em> or <em>Li</em> boundaries from image analysis</li>
<li class="fragment">Optional: use CTCF enrichment to guide the thresholding</li>
</ul></li>
</ul>
</div>
<div class="fragment">
<p><em>Many methods exist for calling TADs <span class="math inline">\(\rightarrow\)</span> different results from different approaches</em></p>
</div>
<div class="fragment" style="font-size:0.8em;">
<blockquote>
<p><em>“[…] an example of how adjacent boundaries calculated with cooltools</em> <em>can specify a set of intervals that could be analyzed as TADs, […]“</em> <br> <span style="margin-left:50pt;font-style:italic">—cooltools documentation</span></p>
</blockquote>
</div>
<aside class="notes">
<ul>
<li><strong>insulation score:</strong> draw a sliding window on the diagonal of a matrix, draw insulation profile</li>
<li><strong>boundaries:</strong> draw local minima,</li>
<li><strong>threshold:</strong> draw and explain prominence, mark strong/weak boundaries we can borrow thresholding methods from image analysis as CTCF is shown to be enriched at TAD boundaries, we can use CTCF enrichment to guide the thresholds as well</li>
<li>There is not concensus about the correct method</li>
<li>Healthy vagueness</li>
</ul>
<style type="text/css">
        span.MJX_Assistive_MathML {
          position:absolute!important;
          clip: rect(1px, 1px, 1px, 1px);
          padding: 1px 0 0 0!important;
          border: 0!important;
          height: 1px!important;
          width: 1px!important;
          overflow: hidden!important;
          display:block!important;
      }</style></aside>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-misteli2020selforganizinggenomeprinciples" class="csl-entry" role="listitem">
Misteli, Tom. 2020. <span>“The <span>Self-Organizing Genome</span>: <span>Principles</span> of <span>Genome Architecture</span> and <span>Function</span>.”</span> <em>Cell</em> 183 (1): 28–45. <a href="https://doi.org/10.1016/j.cell.2020.09.014">https://doi.org/10.1016/j.cell.2020.09.014</a>.
</div>
<div id="ref-skov2023extraordinaryselectionhuman" class="csl-entry" role="listitem">
Skov, Laurits, Moisès Coll Macià, Elise Anne Lucotte, Maria Izabel Alves Cavassim, David Castellano, Mikkel Heide Schierup, and Kasper Munch. 2023. <span>“Extraordinary Selection on the Human <span>X</span> Chromosome Associated with Archaic Admixture.”</span> <em>Cell Genomics</em> 3 (3): 100274. <a href="https://doi.org/10.1016/j.xgen.2023.100274">https://doi.org/10.1016/j.xgen.2023.100274</a>.
</div>
<div id="ref-wang2019reprogrammingmeioticchromatin" class="csl-entry" role="listitem">
Wang, Yao, Hanben Wang, Yu Zhang, Zhenhai Du, Wei Si, Suixing Fan, Dongdong Qin, et al. 2019. <span>“Reprogramming of <span>Meiotic Chromatin Architecture</span> During <span>Spermatogenesis</span>.”</span> <em>Molecular Cell</em> 73 (3): 547–561.e6. <a href="https://doi.org/10.1016/j.molcel.2018.11.019">https://doi.org/10.1016/j.molcel.2018.11.019</a>.
</div>
<div id="ref-wikimedia:HiCschematic" class="csl-entry" role="listitem">
WikiCommons:Prakrutiuday. <span>“HiCschematic (Cutout).”</span> <a href="https://commons.wikimedia.org/wiki/File:HiCschematic.png">https://commons.wikimedia.org/wiki/File:HiCschematic.png</a>.
</div>
</div>

</section></section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="aulogo_uk_var2_blue.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><em>Chromatin Architecture and Selection on X &nbsp; • &nbsp; Søren Jørgensen &nbsp; • &nbsp; MSc. Bioinformatics &nbsp; • &nbsp; munch-group.org/hic-spermatogenesis </em> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="defence_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="defence_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="defence_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="defence_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="defence_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="defence_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="defence_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="defence_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="defence_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="defence_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 0.3,
'autoAnimateUnmatched': false,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: false,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1080,

        height: 720,

        // Factor of the display size that should remain empty around the content
        margin: 5.0e-2,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <style>
      .hide {
        display: none !important;
      }
    </style>


    <script>
      function remove() {
        let footer = document.querySelector('div.footer');
        let slideNo = document.querySelector('div.slide-number');
        slideNo.classList.add('hide');
        footer.classList.add('hide');
      
        Reveal.on('slidechanged', event => {  
          if(Reveal.isFirstSlide()) {
            slideNo.classList.add('hide');
            footer.classList.add('hide');
          } else {
            slideNo.classList.remove('hide');
            footer.classList.remove('hide');
          }
        });
      }
      
      window.onload = remove();
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>